var documenterSearchIndex = {"docs":
[{"location":"exemples/fitting_sklar/#Fitting-compound-distributions","page":"Fitting compound distributions","title":"Fitting compound distributions","text":"","category":"section"},{"location":"exemples/fitting_sklar/","page":"Fitting compound distributions","title":"Fitting compound distributions","text":"Through the SklarDist interface, there is the possiiblity to fit directly distributions that are constructed from a copula and some marginals:","category":"page"},{"location":"exemples/fitting_sklar/","page":"Fitting compound distributions","title":"Fitting compound distributions","text":"using Copulas\nusing Distributions\n\n# Let's sample some datas:\nX‚ÇÅ = LogNormal()\nX‚ÇÇ = Pareto()\nX‚ÇÉ = Gamma()\nX‚ÇÑ = Normal()\nC = SurvivalCopula(FrankCopula(4,7),(2,4))\nD = SklarDist(C,(X‚ÇÅ,X‚ÇÇ,X‚ÇÉ,X‚ÇÑ))\ndata = rand(D,1000)\n\n# The fit function uses a type as its first argument that describes the structure of the model : \nMyCop = SurvivalCopula{4,ClaytonCopula,(2,4)}\nMyMargs = Tuple{LogNormal,Pareto,Gamma,Normal}\nMyD = SklarDist{MyCop, MyMargs}\nfitted_model = fit(MyD,data)\n\n# Another posisbility is to use an empirical copula and only fit the marginals: \nother_fitted_model = fit(SklarDist{EmpiricalCopula,MyMargs},data)","category":"page"},{"location":"exemples/fitting_sklar/","page":"Fitting compound distributions","title":"Fitting compound distributions","text":"This simple interface leverages indeed the fit functon from Distributions.jl. From their documentation, this function is not supposed to use a particular method but to fit \"dirt and quick\" some distributions. ","category":"page"},{"location":"exemples/fitting_sklar/","page":"Fitting compound distributions","title":"Fitting compound distributions","text":"So you have to be carefull : the fit method might not be the same for different copulas or different marginals. For exemples, the archimedean copulas are fitted through an inversion of the kendall tau function, while the gaussian copula is fitted by maximum likelyhood. ","category":"page"},{"location":"elliptical/generalities/","page":"General Discussion","title":"General Discussion","text":"CurrentModule = Copulas","category":"page"},{"location":"elliptical/generalities/#General-Discussion","page":"General Discussion","title":"General Discussion","text":"","category":"section"},{"location":"elliptical/generalities/","page":"General Discussion","title":"General Discussion","text":"Details about the elliptical Copulas","category":"page"},{"location":"elliptical/generalities/","page":"General Discussion","title":"General Discussion","text":"explain how we could define a generic elliptical copulas, and methods that are related to them. ","category":"page"},{"location":"elliptical/generalities/","page":"General Discussion","title":"General Discussion","text":"EllipticalCopula","category":"page"},{"location":"elliptical/generalities/#Copulas.EllipticalCopula","page":"General Discussion","title":"Copulas.EllipticalCopula","text":"EllipticalCopula{d,MT}\n\nAbstract type.\n\n[The description of the API should be here...]\n\n\n\n\n\n","category":"type"},{"location":"exemples/turing/#Bayesian-inference-with-Turing.jl","page":"Bayesian inference with Turing.jl","title":"Bayesian inference with Turing.jl","text":"","category":"section"},{"location":"exemples/turing/","page":"Bayesian inference with Turing.jl","title":"Bayesian inference with Turing.jl","text":"The compatibility with the broader Distributions.jl's API allows a lot of interactions with the broader eco-system. One of the firsts examples that we discovered was the possibility to do bayesian inference of model parameters with Turing.jl. ","category":"page"},{"location":"exemples/turing/","page":"Bayesian inference with Turing.jl","title":"Bayesian inference with Turing.jl","text":"Consider that we have a model with :","category":"page"},{"location":"exemples/turing/","page":"Bayesian inference with Turing.jl","title":"Bayesian inference with Turing.jl","text":"A given parametric dependence structure, say a Clayton Copula. \nA few given parametric marginals. ","category":"page"},{"location":"exemples/turing/","page":"Bayesian inference with Turing.jl","title":"Bayesian inference with Turing.jl","text":"Then we can use Turing's @addlogprob! to compute the loglikelyhood of our model and maximize it around th eparameters alongside the chain as folows: ","category":"page"},{"location":"exemples/turing/","page":"Bayesian inference with Turing.jl","title":"Bayesian inference with Turing.jl","text":"using Copulas\nusing Distributions\nusing Random\nusing Turing\nusing StatsPlots\n\nRandom.seed!(123)\ntrue_Œ∏ = 7\ntrue_Œ∏‚ÇÅ = 1\ntrue_Œ∏‚ÇÇ = 3\ntrue_Œ∏‚ÇÉ = 2\nD = SklarDist(ClaytonCopula(3,true_Œ∏), (Exponential(true_Œ∏‚ÇÅ), Pareto(true_Œ∏‚ÇÇ), Exponential(true_Œ∏‚ÇÉ)))\ndraws = rand(D, 200)\n\n@model function copula(X)\n    # Priors\n    Œ∏  ~ TruncatedNormal(1.0, 1.0, -1/3, Inf)\n    Œ∏‚ÇÅ ~ TruncatedNormal(1.0, 1.0, 0, Inf)\n    Œ∏‚ÇÇ ~ TruncatedNormal(1.0, 1.0, 0, Inf)\n    Œ∏‚ÇÉ ~ TruncatedNormal(1.0, 1.0, 0, Inf)\n\n    # Build the parametric model\n    C = ClaytonCopula(3,Œ∏)\n    X‚ÇÅ = Exponential(Œ∏‚ÇÅ)\n    X‚ÇÇ = Pareto(Œ∏‚ÇÇ)\n    X‚ÇÉ = Exponential(Œ∏‚ÇÉ)\n    D = SklarDist(C, (X‚ÇÅ, X‚ÇÇ, X‚ÇÉ))\n\n    # Compute the final loglikelyhood\n    Turing.Turing.@addlogprob! loglikelihood(D, X)\nend\n\nsampler = NUTS() # MH() works too\nchain = sample(copula(draws), sampler, MCMCThreads(), 100, 4)\nplot(chain)","category":"page"},{"location":"exemples/turing/","page":"Bayesian inference with Turing.jl","title":"Bayesian inference with Turing.jl","text":"This kind of model could be used to do a lot of stuff. here we use it for a parametric estimation of a sampling model, but it could be used for other things such as, e.g., a bayesian regression with an error structure given by a parmaetric copula.","category":"page"},{"location":"exemples/turing/","page":"Bayesian inference with Turing.jl","title":"Bayesian inference with Turing.jl","text":"Note that we truncated the Œ∏ parameter at -1/3 and not 0 as the ClaytonCopula can handle negative dependence structures. ","category":"page"},{"location":"sklar/","page":"Sklar's Theorem","title":"Sklar's Theorem","text":"CurrentModule = Copulas","category":"page"},{"location":"sklar/#Implementation","page":"Sklar's Theorem","title":"Implementation","text":"","category":"section"},{"location":"sklar/","page":"Sklar's Theorem","title":"Sklar's Theorem","text":"The Sklar Theorem allows to compute distributions, satisfying the Distriutions.jl API, thaty are \"compound\" with a given copula and given marginals. ","category":"page"},{"location":"sklar/","page":"Sklar's Theorem","title":"Sklar's Theorem","text":"SklarDist","category":"page"},{"location":"sklar/#Copulas.SklarDist","page":"Sklar's Theorem","title":"Copulas.SklarDist","text":"SklarDist{CT,TplMargins}\n\nFields:\n\nC::CT - The copula\nm::TplMargins - a Tuple representing the marginal distributions\n\nConstructor\n\nSklarDist(C,m)\n\nThis function allows to construct a random vector specified, through the Sklar Theorem, by its marginals and its copula separately. See Sklar's theorem. \n\nThe obtain random vector follows Distributions.jl's API and can be sampled, pdf and cdf can be evaluated, etc... We even provide a fit function. See the folowing exemple code : \n\nusing Copulas, Distributions, Random\nX‚ÇÅ = Gamma(2,3)\nX‚ÇÇ = Pareto()\nX‚ÇÉ = LogNormal(0,1)\nC = ClaytonCopula(3,0.7) # A 3-variate Clayton Copula with Œ∏ = 0.7\nD = SklarDist(C,(X‚ÇÅ,X‚ÇÇ,X‚ÇÉ)) # The final distribution\n\n# This generates a (3,1000)-sized dataset from the multivariate distribution D\nsimu = rand(D,1000)\n\n# While the following estimates the parameters of the model from a dataset: \nDÃÇ = fit(SklarDist{FrankCopula,Tuple{Gamma,Normal,LogNormal}}, simu)\n# Increase the number of observations to get a beter fit (or not?)  \n\n\n\n\n\n","category":"type"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"CurrentModule = Copulas","category":"page"},{"location":"archimedean/generalities/#General-Discussion","page":"General Discussion","title":"General Discussion","text":"","category":"section"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"Archimedean copulas are a large class of copulas that are defined as : ... [ details needed...]","category":"page"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"In our implementation, we separate the generator, in the Generator type, from the copula itself. The easyest way to understand this orthogonal design is to look at the Clayton implementation. ","category":"page"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"We have the ClaytonGenerator that is defined as follows: ","category":"page"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"struct ClaytonGenerator{T} <: UnivariateGenerator\n    Œ∏::T\n    function ClaytonGenerator(Œ∏)\n        if Œ∏ < -1\n            throw(ArgumentError(\"Theta must be greater than -1\"))\n        elseif Œ∏ == -1\n            return WGenerator()\n        elseif Œ∏ == 0\n            return IndependentGenerator()\n        elseif Œ∏ == Inf\n            return MGenerator()\n        else\n            return new{typeof(Œ∏)}(Œ∏)\n        end\n    end\nend\nmax_monotony(G::ClaytonGenerator) = G.Œ∏ >= 0 ? Inf : Int(floor(1 - 1/G.Œ∏))\nœï(  G::ClaytonGenerator, t) = max(1+G.Œ∏*t,zero(t))^(-1/G.Œ∏)\nœï‚Åª¬π(G::ClaytonGenerator, t) = (t^(-G.Œ∏)-1)/G.Œ∏\n# œï‚ÅΩ¬π‚Åæ(G::ClaytonGenerator, t) =  First derivative of œï\n# œï‚ÅΩ·µè‚Åæ(G::ClaytonGenerator, k, t) = kth derivative of œï\nœÑ(G::ClaytonGenerator) = ifelse(isfinite(G.Œ∏), G.Œ∏/(G.Œ∏+2), 1)\nœÑ‚Åª¬π(::Type{T},œÑ) where T<:ClaytonGenerator = ifelse(œÑ == 1,Inf,2œÑ/(1-œÑ))\nwilliamson_dist(G::ClaytonGenerator, d) = G.Œ∏ >= 0 ? WilliamsonFromFrailty(Distributions.Gamma(1/G.Œ∏,G.Œ∏),d) : ClaytonWilliamsonDistribution(G.Œ∏,d)","category":"page"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"And then the ClaytonCopula{d,T} is simply an alias for ArchimedeanCopula{d,ClaytonGenerator{T}}: ","category":"page"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"const ClaytonCopula{d,T} = ArchimedeanCopula{d,ClaytonGenerator{T}}\nClaytonCopula(d,Œ∏) = ArchimedeanCopula(d,ClaytonGenerator(Œ∏))\ngeneratorof(::Type{ClaytonCopula}) = ClaytonGenerator","category":"page"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"Not everything is necessary however, depending on the features you need. Indeed, the Archimedean API is modular: ","category":"page"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"Only œï and max_monotony are really required. Indeed, all other functions have generic fallbacks. In particular, the williamson_dist has a generic fallback that uses WilliamsonTransforms.jl for any generator. Note however that providing the williamson_dist yourself if you know it will allow sampling to be an order of magnitude faster: see how in the ClaytonCopula case we provided a sampler that is different for positive parameters (the generator is completely monotonous, and thus the frailty distribution is known, so we used WilliamsonFromFrailty), and the negative dependent cases, where only the CDF is known and implemented in ClaytonWilliamsonDistribution.\nTo evaluate the cdf and (log-)density in any dimension, only œï and œï‚Åª¬π are needed.\nCurrently, to fit the copula œÑ‚Åª¬π is needed as we use the inverse tau moment method. But we plan on also implementing inverse rho and MLE (density needed). \nNote that the generator œï follows the convention œï(0)=1, while others (e.g., https://en.wikipedia.org/wiki/Copula(probabilitytheory)#Archimedean_copulas) use œï‚Åª¬π as the generator.","category":"page"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"ArchimedeanCopula","category":"page"},{"location":"archimedean/generalities/#Copulas.ArchimedeanCopula","page":"General Discussion","title":"Copulas.ArchimedeanCopula","text":"ArchimedeanCopula{d, TG}\n\nFields:      - G::TG : the generator <: Generator. \n\nConstructor: \n\nArchimedeanCopula(d::Int,G::Generator)\n\nFor some archimedean generator G::Generator and some dimenson d, this class models the archimedean copula wich has this generator. More formally, a d-monotone archimedean generator is a function phi on mathbb R_+ that has these three properties:\n\nphi(0) = 1 and phi(Inf) = 0\nphi is d-2 times derivable, and the signs of its derivatives alternates : forall k in 0d-2 (-1)^k phi^(k) ge 0.\nphi^(d-2) is convex.\n\nIn the code, this function is implemented as œï(G::Generator,t), and its max monotony d is given by max_monotony(G). The corresponding d-variate archimedean copula writes: \n\nC(mathbf u) = phi^-1left(sum_i=1^d phi(u_i)right)\n\nIt can be sampled through A Radial simplex decomposition as follows: If mathbf U sim C, then U equal R mathbf S for a random vector mathbf S sim Dirichlet(ones(d)), that is uniformity on the d-variate simplex, and a non-negative random variable R that is the Williamson d-transform of \\phi. The density, cdf, kendall tau, and may other properties of the Archimedean copula are then directly deduced from this relationship. \n\nThere exists several known parametric generators that are implement in the package. For every NamedGenerator <: Generator implemented in the package, we provide a type alias `NamedCopula{d,...} = ArchimedeanCopula{d,NamedGenerator{...}} to be able to manipulate the archimedean copulas without too much hassle for known and usefull special cases. \n\nA generic archimdeanc copula can be constructed as follows: \n\nstruct MyGenerator <: Generator end\nœï(G::MyGenerator,t) = exp(-t) # your archimedean generator, can be any d-monotonous function.\nmax_monotony(G::MyGenerator) = Inf # could depend on generators parameters. \nC = ArchimedeanCopula(d,MyGenerator())\n\nThe obtained model can be used as follows: \n\nspl = rand(C,1000)   # sampling\ncdf(C,spl)           # cdf\npdf(C,spl)           # pdf\nloglikelihood(C,spl) # llh\n\nThe following functions have defaults but can be overridden for performance: \n\nœï‚Åª¬π(C::MyArchimedean, t)        # Inverse of œï\nœï‚ÅΩ¬π‚Åæ(C::MyArchimedean, t)       # first defrivative of œï\nœï‚ÅΩ·µà‚Åæ(C::MyArchimedean,t)        # dth defrivative of œï\nœÑ(C::MyArchimedean)             # Kendall tau\nœÑ‚Åª¬π(::Type{MyArchimedean},œÑ) =  # Inverse kendall tau\nfit(::Type{MyArchimedean},data) # fitting.\n\nAs a bonus, If you know the williamson d-transform of your generator and not your generator itself, you may take a look at WilliamsonGenerator that implements them. If you rather know the frailty distribution, take a look at WilliamsonFromFrailty.\n\nReferences:      Williamson, R. E. (1956). Multiply monotone functions and their Laplace transforms. Duke Math. J. 23 189‚Äì207. MR0077581     McNeil, Alexander J., and Johanna Ne≈°lehov√°. \"Multivariate Archimedean copulas, d-monotone functions and ‚Ñì 1-norm symmetric distributions.\" (2009): 3059-3097.\n\n\n\n\n\n","category":"type"},{"location":"archimedean/generalities/#Implement-your-own","page":"General Discussion","title":"Implement your own","text":"","category":"section"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"If you think that the WilliamsonCopula interface is too barebone and does not provide you with enough flexibility in your modeling of an archimedean copula, you might be intersted in the possiiblity to directly subtype ArchimedeanCopula and implement your own. This is actually a fairly easy process and you only need to implement a few functions. Let's here together try to reimplement come archimedean copula with the foll√ßowing generator: ","category":"page"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"my_generator","category":"page"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"(describe the process...)","category":"page"},{"location":"archimedean/generalities/","page":"General Discussion","title":"General Discussion","text":"struct MyAC{d,T} <: ArchimedeanCopula{d}\n    par::T\nend\nœï(C::MyAC{d},x)\nœï‚Åª¬π(C::MyAC{d},x)\nœÑ(C::MyAC{d})\nœÑ‚Åª¬π(::MyAC{d},œÑ)\nwilliamson_dist(C::MyAC{d})","category":"page"},{"location":"reference/","page":"Reference","title":"Reference","text":"CurrentModule = Copulas","category":"page"},{"location":"reference/#Reference","page":"Reference","title":"Reference","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"All docstrings are copied here as a general reference.","category":"page"},{"location":"reference/","page":"Reference","title":"Reference","text":"Modules = [Copulas]","category":"page"},{"location":"reference/#Copulas.AMHGenerator-reference","page":"Reference","title":"Copulas.AMHGenerator","text":"AMHGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nAMHGenerator(Œ∏)\nAMHCopula(d,Œ∏)\n\nThe AMH copula in dimension d is parameterized by theta in -11). It is an Archimedean copula with generator : \n\nphi(t) = 1 - frac1-thetae^-t-theta\n\nIt has a few special cases: \n\nWhen Œ∏ = 0, it is the IndependentCopula\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.ArchimedeanCopula-reference","page":"Reference","title":"Copulas.ArchimedeanCopula","text":"ArchimedeanCopula{d, TG}\n\nFields:      - G::TG : the generator <: Generator. \n\nConstructor: \n\nArchimedeanCopula(d::Int,G::Generator)\n\nFor some archimedean generator G::Generator and some dimenson d, this class models the archimedean copula wich has this generator. More formally, a d-monotone archimedean generator is a function phi on mathbb R_+ that has these three properties:\n\nphi(0) = 1 and phi(Inf) = 0\nphi is d-2 times derivable, and the signs of its derivatives alternates : forall k in 0d-2 (-1)^k phi^(k) ge 0.\nphi^(d-2) is convex.\n\nIn the code, this function is implemented as œï(G::Generator,t), and its max monotony d is given by max_monotony(G). The corresponding d-variate archimedean copula writes: \n\nC(mathbf u) = phi^-1left(sum_i=1^d phi(u_i)right)\n\nIt can be sampled through A Radial simplex decomposition as follows: If mathbf U sim C, then U equal R mathbf S for a random vector mathbf S sim Dirichlet(ones(d)), that is uniformity on the d-variate simplex, and a non-negative random variable R that is the Williamson d-transform of \\phi. The density, cdf, kendall tau, and may other properties of the Archimedean copula are then directly deduced from this relationship. \n\nThere exists several known parametric generators that are implement in the package. For every NamedGenerator <: Generator implemented in the package, we provide a type alias `NamedCopula{d,...} = ArchimedeanCopula{d,NamedGenerator{...}} to be able to manipulate the archimedean copulas without too much hassle for known and usefull special cases. \n\nA generic archimdeanc copula can be constructed as follows: \n\nstruct MyGenerator <: Generator end\nœï(G::MyGenerator,t) = exp(-t) # your archimedean generator, can be any d-monotonous function.\nmax_monotony(G::MyGenerator) = Inf # could depend on generators parameters. \nC = ArchimedeanCopula(d,MyGenerator())\n\nThe obtained model can be used as follows: \n\nspl = rand(C,1000)   # sampling\ncdf(C,spl)           # cdf\npdf(C,spl)           # pdf\nloglikelihood(C,spl) # llh\n\nThe following functions have defaults but can be overridden for performance: \n\nœï‚Åª¬π(C::MyArchimedean, t)        # Inverse of œï\nœï‚ÅΩ¬π‚Åæ(C::MyArchimedean, t)       # first defrivative of œï\nœï‚ÅΩ·µà‚Åæ(C::MyArchimedean,t)        # dth defrivative of œï\nœÑ(C::MyArchimedean)             # Kendall tau\nœÑ‚Åª¬π(::Type{MyArchimedean},œÑ) =  # Inverse kendall tau\nfit(::Type{MyArchimedean},data) # fitting.\n\nAs a bonus, If you know the williamson d-transform of your generator and not your generator itself, you may take a look at WilliamsonGenerator that implements them. If you rather know the frailty distribution, take a look at WilliamsonFromFrailty.\n\nReferences:      Williamson, R. E. (1956). Multiply monotone functions and their Laplace transforms. Duke Math. J. 23 189‚Äì207. MR0077581     McNeil, Alexander J., and Johanna Ne≈°lehov√°. \"Multivariate Archimedean copulas, d-monotone functions and ‚Ñì 1-norm symmetric distributions.\" (2009): 3059-3097.\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.ClaytonGenerator-reference","page":"Reference","title":"Copulas.ClaytonGenerator","text":"ClaytonGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nClaytonGenerator(Œ∏)\nClaytonCopula(d,Œ∏)\n\nThe Clayton copula in dimension d is parameterized by theta in -1(d-1)infty). It is an Archimedean copula with generator : \n\nphi(t) = left(1+mathrmsign(theta)*tright)^-1frac1theta\n\nIt has a few special cases: \n\nWhen Œ∏ = -1/(d-1), it is the WCopula (Lower Frechet-Hoeffding bound)\nWhen Œ∏ = 0, it is the IndependentCopula\nWhen Œ∏ = ‚àû, is is the MCopula (Upper Frechet-Hoeffding bound)\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.EllipticalCopula-reference","page":"Reference","title":"Copulas.EllipticalCopula","text":"EllipticalCopula{d,MT}\n\nAbstract type.\n\n[The description of the API should be here...]\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.EmpiricalCopula-reference","page":"Reference","title":"Copulas.EmpiricalCopula","text":"EmpiricalCopula{d,MT}\n\nFields:\n\nu::MT - the matrix of observations. \n\nConstructor\n\nEmpiricalCopula(u;pseudos=true)\n\nThe EmpiricalCopula in dimension d is parameterized by a pseudo-data matrix wich should have shape (d,N). Its expression is given as :  \n\nC(mathbf x) = frac1Nsum_i=1^n mathbf 1_mathbf u_i le mathbf x\n\nThis function is very practical, be be aware that this is not a true copula (since mathbf u are only pseudo-observations). The constructor allows you to pass dirctly pseudo-observations (the default) or will compute them for you. You can then compute the cdf of the copula, and sample it through the standard interface.\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.FGMCopula-reference","page":"Reference","title":"Copulas.FGMCopula","text":"FGMCopula{d,T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nFGMCopula(d, Œ∏)\n\nThe Multivariate Farlie-Gumbel-Morgenstern (FGM) copula of dimension d has 2^d-d-1 parameters theta and function\n\nC(boldsymbolu)=prod_i=1^du_i left1+ sum_k=2^dsum_1 leq j_1  cdots  j_k leq d theta_j_1 cdots j_k baru_j_1cdots baru_j_k right\n\nwhere baru=1-u.\n\nMore details about Farlie-Gumbel-Morgenstern (FGM) copula are found in :\n\nNelsen, Roger B. An introduction to copulas. Springer, 2006. Exercise 3.38.\n\nWe use the stochastic representation of the copula to obtain random samples.\n\nBlier-Wong, C., Cossette, H., & Marceau, E. (2022). Stochastic representation of FGM copulas using multivariate Bernoulli random variables. Computational Statistics & Data Analysis, 173, 107506.\n\nIt has a few special cases:\n\nWhen d=2 and Œ∏ = 0, it is the IndependentCopula.\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.FrankGenerator-reference","page":"Reference","title":"Copulas.FrankGenerator","text":"FrankGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nFrankGenerator(Œ∏)\nFrankCopula(d,Œ∏)\n\nThe Frank copula in dimension d is parameterized by theta in -inftyinfty). It is an Archimedean copula with generator : \n\nphi(t) = -fraclogleft(1+e^-t(e^-theta-1)right)\theta\n\nIt has a few special cases: \n\nWhen Œ∏ = -‚àû, it is the WCopula (Lower Frechet-Hoeffding bound)\nWhen Œ∏ = 1, it is the IndependentCopula\nWhen Œ∏ = ‚àû, is is the MCopula (Upper Frechet-Hoeffding bound)\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.GaussianCopula-reference","page":"Reference","title":"Copulas.GaussianCopula","text":"GaussianCopula{d,MT}\n\nFields:\n\nŒ£::MT - covariance matrix\n\nConstructor\n\nGaussianCopula(Œ£)\n\nThe Gaussian Copula is the  copula of a Multivariate normal distribution. It is constructed as : \n\nC(mathbfx boldsymbolSigma) = F_Sigma(F_Sigmai^-1(x_i)iin 1d)\n\nwhere F_Sigma is a cdf of a gaussina random vector and F_{\\Sigma,i} is the ith marignal cdf, while `Sigma is the covariance matrix. \n\nIt can be constructed in Julia via:  \n\nC = GaussianCopula(Œ£)\n\nThe random number generation works as expected:\n\nrand(C,1000)\n# or\nRandom.rand!(C,u)\n\nAnd yo can fit the distribution via : \n\nfit(GaussianCopula,data)\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.GumbelBarnettGenerator-reference","page":"Reference","title":"Copulas.GumbelBarnettGenerator","text":"GumbelBarnettGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nGumbelBarnettGenerator(Œ∏)\nGumbelBarnettCopula(d,Œ∏)\n\nThe Gumbel-Barnett copula is an archimdean copula with generator:\n\nphi(t) = expŒ∏^-1(1-e^t) 0 leq theta leq 1\n\nMore details about Gumbel-Barnett copula are found in:\n\nJoe, H. (2014). Dependence modeling with copulas. CRC press, Page.437\n\nIt has a few special cases: \n\nWhen Œ∏ = 0, it is the IndependentCopula\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.GumbelGenerator-reference","page":"Reference","title":"Copulas.GumbelGenerator","text":"GumbelGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nGumbelGenerator(Œ∏)\nGumbelCopula(d,Œ∏)\n\nThe Gumbel copula in dimension d is parameterized by theta in 1infty). It is an Archimedean copula with generator : \n\nphi(t) = exp-t^frac1Œ∏\n\nIt has a few special cases: \n\nWhen Œ∏ = 1, it is the IndependentCopula\nWhen Œ∏ = ‚àû, is is the MCopula (Upper Frechet-Hoeffding bound)\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.IndependentGenerator-reference","page":"Reference","title":"Copulas.IndependentGenerator","text":"IndependentGenerator\n\nConstructor\n\nIndependentGenerator()\nIndependentCopula(d)\n\nThe Independent Copula in dimension d is the simplest copula, that has the form : \n\nC(mathbfx) = prod_i=1^d x_i\n\nIt happends to be an Archimedean Copula, with generator : \n\nphi(t) = exp-t\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.InvGaussianGenerator-reference","page":"Reference","title":"Copulas.InvGaussianGenerator","text":"InvGaussianGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nInvGaussianGenerator(Œ∏)\nInvGaussianCopula(d,Œ∏)\n\nThe Inverse Gaussian copula in dimension d is parameterized by theta in 0infty). It is an Archimedean copula with generator :\n\nphi(t) = expfrac(1-sqrt1+2Œ∏^2tŒ∏\n\nMore details about Inverse Gaussian Archimedean copula are found in :\n\nMai, Jan-Frederik, and Matthias Scherer. Simulating copulas: stochastic models, sampling algorithms, and applications. Vol. 6. # N/A, 2017. Page 74.\n\nIt has a few special cases:\n\nWhen Œ∏ = 0, it is the IndependentCopula\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.JoeGenerator-reference","page":"Reference","title":"Copulas.JoeGenerator","text":"JoeGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nJoeGenerator(Œ∏)\nJoeCopula(d,Œ∏)\n\nThe Joe copula in dimension d is parameterized by theta in 1infty). It is an Archimedean copula with generator : \n\nphi(t) = 1 - left(1 - e^-tright)^frac1theta\n\nIt has a few special cases: \n\nWhen Œ∏ = 1, it is the IndependentCopula\nWhen Œ∏ = ‚àû, is is the MCopula (Upper Frechet-Hoeffding bound)\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.MGenerator-reference","page":"Reference","title":"Copulas.MGenerator","text":"MGenerator\n\nConstructor\n\nMGenerator()\nMCopula(d)\n\nThe Upper Frechet-Hoeffding bound is the copula with the greatest value among all copulas. It correspond to comonotone random vectors. \n\nFor any copula C, if W and M are (respectively) the lower and uppder Frechet-Hoeffding bounds, we have that for all mathbfu in 01^d,\n\nW(mathbfu) le C(mathbfu) le M(mathbfu)\n\nThe two Frechet-Hoeffding bounds are also Archimedean copulas.\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.PlackettCopula-reference","page":"Reference","title":"Copulas.PlackettCopula","text":"PlackettCopula{P}\n\nFields:     - Œ∏::Real - parameter\n\nConstructor\n\nPlackettCopula(Œ∏)\n\nParameterized by theta  0 The Plackett copula is\n\nC_theta(uv) = fracleft 1+(theta-1)(u+v)right- sqrt1+(theta-1)(u+v)^2-4uvtheta(theta-1)2(theta-1)\n\nand for theta = 1\n\nC_1(uv) = uv \n\nIt has a few special cases: \n\nWhen Œ∏ = 0, is is the MCopula (Upper Frechet-Hoeffding bound)\nWhen Œ∏ = 1, it is the IndependentCopula\nWhen Œ∏ = ‚àû, is is the WCopula (Lower Frechet-Hoeffding bound)\n\nMore details about Plackett Copula are found in:\n\nJoe, H. (2014). Dependence modeling with copulas. CRC press, Page.164\n\nDetails about the algorithm to generate copula samples can be seen in the following references:\n\nJohnson, Mark E. Multivariate statistical simulation:\nA guide to selecting and generating continuous multivariate distributions.\nVol. 192. John Wiley & Sons, 1987. Page 193.\nNelsen, Roger B. An introduction to copulas. Springer, 2006. Exercise 3.38.\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.SklarDist-reference","page":"Reference","title":"Copulas.SklarDist","text":"SklarDist{CT,TplMargins}\n\nFields:\n\nC::CT - The copula\nm::TplMargins - a Tuple representing the marginal distributions\n\nConstructor\n\nSklarDist(C,m)\n\nThis function allows to construct a random vector specified, through the Sklar Theorem, by its marginals and its copula separately. See Sklar's theorem. \n\nThe obtain random vector follows Distributions.jl's API and can be sampled, pdf and cdf can be evaluated, etc... We even provide a fit function. See the folowing exemple code : \n\nusing Copulas, Distributions, Random\nX‚ÇÅ = Gamma(2,3)\nX‚ÇÇ = Pareto()\nX‚ÇÉ = LogNormal(0,1)\nC = ClaytonCopula(3,0.7) # A 3-variate Clayton Copula with Œ∏ = 0.7\nD = SklarDist(C,(X‚ÇÅ,X‚ÇÇ,X‚ÇÉ)) # The final distribution\n\n# This generates a (3,1000)-sized dataset from the multivariate distribution D\nsimu = rand(D,1000)\n\n# While the following estimates the parameters of the model from a dataset: \nDÃÇ = fit(SklarDist{FrankCopula,Tuple{Gamma,Normal,LogNormal}}, simu)\n# Increase the number of observations to get a beter fit (or not?)  \n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.SurvivalCopula-reference","page":"Reference","title":"Copulas.SurvivalCopula","text":"SurvivalCopula{d,CT,VI}\n\nConstructor\n\nSurvivalCopula(C,indices)\n\nComputes the survival version of any copula on given indices. From a copula C in dimension d, and some indices i_1i_k in 1d, the survival copula associated simply reverses its arguments on chosen indices. For exemple, for d=4 and indices (23), we have: \n\nS(u_1u_4) = C(u_11-u_21-u3u_4)\n\nThis constructor allows to derive new \"survival\" families. For exemple, in bivariate cases, this allows to do \"rotations\". The obtained models can be treated as the starting one, i.e. as a random vector in [0,1]^d with uniforms marginals. \n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.TCopula-reference","page":"Reference","title":"Copulas.TCopula","text":"TCopula{d,MT}\n\nFields:\n\ndf::Int - number of degree of freedom\nŒ£::MT - covariance matrix\n\nConstructor\n\nTCopula(df,Œ£)\n\nThe Student's T Copula is the  copula of a Multivariate Student distribution. It is constructed as : \n\nC(mathbfx boldsymbolnSigma) = F_nSigma(F_nSigmai^-1(x_i)iin 1d)\n\nwhere F_nSigma is a cdf of a multivariate student random vector with covariance matrix Sigma and n degrees of freedom. and F_{n,\\Sigma,i} is the ith marignal cdf. \n\nIt can be constructed in Julia via:  \n\nC = TCopula(n,Œ£)\n\nThe random number generation works as expected:\n\nrand(C,1000)\n# or\nRandom.rand!(C,u)\n\nAnd yo can fit the distribution via : \n\nfit(TCopula,data)\n\nExcept that currently it does not work since fit(Distributions.MvTDist,data) does not dispatch. \n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.WGenerator-reference","page":"Reference","title":"Copulas.WGenerator","text":"WGenerator\n\nConstructor\n\nWGenerator()\nWCopula(d)\n\nThe Lower Frechet-Hoeffding bound is the copula with the lowest value among all copulas. Note that W is only a proper copula when d=2, in greater dimensions it is still the (pointwise) lower bound, but not a copula anymore. For any copula C, if W and M are (respectively) the lower and uppder Frechet-Hoeffding bounds, we have that for all mathbfu in 01^d,\n\nW(mathbfu) le C(mathbfu) le M(mathbfu)\n\nThe two Frechet-Hoeffding bounds are also Archimedean copulas.\n\n\n\n\n\n","category":"type"},{"location":"reference/#Copulas.WilliamsonGenerator-reference","page":"Reference","title":"Copulas.WilliamsonGenerator","text":"WilliamsonGenerator{TX}\n\nFields:     - X::TX ‚Äì a random variable that represents its williamson d-transform     - d::Int ‚Äì the dimension of the transformation. \n\nConstructors\n\nWilliamsonGenerator(X::Distributions.UnivariateDistribution, d)\n\nThe WilliamsonGenerator allows to construct a d-monotonous archimedean generator from a positive random variable X::Distributions.UnivariateDistribution. The transformation, wich is called the inverse williamson transformation, is implemented in WilliamsonTransforms.jl. \n\nFor a univariate non-negative random variable X, with cumulative distribution function F and an integer dge 2, the Williamson-d-transform of X is the real function supported on 0infty given by:\n\nphi(t) = ùí≤_d(X)(t) = int_t^infty left(1 - fractxright)^d-1 dF(x) = mathbb Eleft( (1 - fractX)^d-1_+right) mathbb 1_t  0 + left(1 - F(0)right)mathbb 1_t 0\n\nThis function has several properties: \n\nWe have that phi(0) = 1 and phi(Inf) = 0\nphi is d-2 times derivable, and the signs of its derivatives alternates : forall k in 0d-2 (-1)^k phi^(k) ge 0.\nphi^(d-2) is convex.\n\nThese properties makes this function what is called a d-monotone archimedean generator, able to generate archimedean copulas in dimensions up to d. Our implementation provides this through the Generator interface: the function phi can be accessed by \n\nG = WilliamsonGenerator(X, d)\nœï(G,t)\n\nNote that you'll always have:\n\nmax_monotony(WilliamsonGenerator(X,d)) === d\n\nReferences:      Williamson, R. E. (1956). Multiply monotone functions and their Laplace transforms. Duke Math. J. 23 189‚Äì207. MR0077581     McNeil, Alexander J., and Johanna Ne≈°lehov√°. \"Multivariate Archimedean copulas, d-monotone functions and ‚Ñì 1-norm symmetric distributions.\" (2009): 3059-3097.\n\n\n\n\n\n","category":"type"},{"location":"archimedean/generators/#Archimedean-Generators","page":"Archimedean Generators","title":"Archimedean Generators","text":"","category":"section"},{"location":"archimedean/generators/","page":"Archimedean Generators","title":"Archimedean Generators","text":"definition of an archimedean generator... ","category":"page"},{"location":"archimedean/generators/","page":"Archimedean Generators","title":"Archimedean Generators","text":"why are these stuffs usefull... ","category":"page"},{"location":"archimedean/generators/","page":"Archimedean Generators","title":"Archimedean Generators","text":"etc... ","category":"page"},{"location":"archimedean/generators/#The-Generator-API","page":"Archimedean Generators","title":"The Generator API","text":"","category":"section"},{"location":"archimedean/generators/","page":"Archimedean Generators","title":"Archimedean Generators","text":"uses williamson-d-transfrom by default. ","category":"page"},{"location":"archimedean/generators/#The-WilliamsonGenerator-for-Inverse-Williamson-d-transform","page":"Archimedean Generators","title":"The WilliamsonGenerator for Inverse Williamson d-transform","text":"","category":"section"},{"location":"archimedean/generators/","page":"Archimedean Generators","title":"Archimedean Generators","text":"WilliamsonGenerator","category":"page"},{"location":"archimedean/generators/#Copulas.WilliamsonGenerator","page":"Archimedean Generators","title":"Copulas.WilliamsonGenerator","text":"WilliamsonGenerator{TX}\n\nFields:     - X::TX ‚Äì a random variable that represents its williamson d-transform     - d::Int ‚Äì the dimension of the transformation. \n\nConstructors\n\nWilliamsonGenerator(X::Distributions.UnivariateDistribution, d)\n\nThe WilliamsonGenerator allows to construct a d-monotonous archimedean generator from a positive random variable X::Distributions.UnivariateDistribution. The transformation, wich is called the inverse williamson transformation, is implemented in WilliamsonTransforms.jl. \n\nFor a univariate non-negative random variable X, with cumulative distribution function F and an integer dge 2, the Williamson-d-transform of X is the real function supported on 0infty given by:\n\nphi(t) = ùí≤_d(X)(t) = int_t^infty left(1 - fractxright)^d-1 dF(x) = mathbb Eleft( (1 - fractX)^d-1_+right) mathbb 1_t  0 + left(1 - F(0)right)mathbb 1_t 0\n\nThis function has several properties: \n\nWe have that phi(0) = 1 and phi(Inf) = 0\nphi is d-2 times derivable, and the signs of its derivatives alternates : forall k in 0d-2 (-1)^k phi^(k) ge 0.\nphi^(d-2) is convex.\n\nThese properties makes this function what is called a d-monotone archimedean generator, able to generate archimedean copulas in dimensions up to d. Our implementation provides this through the Generator interface: the function phi can be accessed by \n\nG = WilliamsonGenerator(X, d)\nœï(G,t)\n\nNote that you'll always have:\n\nmax_monotony(WilliamsonGenerator(X,d)) === d\n\nReferences:      Williamson, R. E. (1956). Multiply monotone functions and their Laplace transforms. Duke Math. J. 23 189‚Äì207. MR0077581     McNeil, Alexander J., and Johanna Ne≈°lehov√°. \"Multivariate Archimedean copulas, d-monotone functions and ‚Ñì 1-norm symmetric distributions.\" (2009): 3059-3097.\n\n\n\n\n\n","category":"type"},{"location":"elliptical/available_models/","page":"Available elliptical copulas","title":"Available elliptical copulas","text":"CurrentModule = Copulas","category":"page"},{"location":"elliptical/available_models/#Available-elliptical-copulas","page":"Available elliptical copulas","title":"Available elliptical copulas","text":"","category":"section"},{"location":"elliptical/available_models/#Gaussian","page":"Available elliptical copulas","title":"Gaussian","text":"","category":"section"},{"location":"elliptical/available_models/","page":"Available elliptical copulas","title":"Available elliptical copulas","text":"GaussianCopula","category":"page"},{"location":"elliptical/available_models/#Copulas.GaussianCopula","page":"Available elliptical copulas","title":"Copulas.GaussianCopula","text":"GaussianCopula{d,MT}\n\nFields:\n\nŒ£::MT - covariance matrix\n\nConstructor\n\nGaussianCopula(Œ£)\n\nThe Gaussian Copula is the  copula of a Multivariate normal distribution. It is constructed as : \n\nC(mathbfx boldsymbolSigma) = F_Sigma(F_Sigmai^-1(x_i)iin 1d)\n\nwhere F_Sigma is a cdf of a gaussina random vector and F_{\\Sigma,i} is the ith marignal cdf, while `Sigma is the covariance matrix. \n\nIt can be constructed in Julia via:  \n\nC = GaussianCopula(Œ£)\n\nThe random number generation works as expected:\n\nrand(C,1000)\n# or\nRandom.rand!(C,u)\n\nAnd yo can fit the distribution via : \n\nfit(GaussianCopula,data)\n\n\n\n\n\n","category":"type"},{"location":"elliptical/available_models/#Student's-T","page":"Available elliptical copulas","title":"Student's T","text":"","category":"section"},{"location":"elliptical/available_models/","page":"Available elliptical copulas","title":"Available elliptical copulas","text":"TCopula","category":"page"},{"location":"elliptical/available_models/#Copulas.TCopula","page":"Available elliptical copulas","title":"Copulas.TCopula","text":"TCopula{d,MT}\n\nFields:\n\ndf::Int - number of degree of freedom\nŒ£::MT - covariance matrix\n\nConstructor\n\nTCopula(df,Œ£)\n\nThe Student's T Copula is the  copula of a Multivariate Student distribution. It is constructed as : \n\nC(mathbfx boldsymbolnSigma) = F_nSigma(F_nSigmai^-1(x_i)iin 1d)\n\nwhere F_nSigma is a cdf of a multivariate student random vector with covariance matrix Sigma and n degrees of freedom. and F_{n,\\Sigma,i} is the ith marignal cdf. \n\nIt can be constructed in Julia via:  \n\nC = TCopula(n,Œ£)\n\nThe random number generation works as expected:\n\nrand(C,1000)\n# or\nRandom.rand!(C,u)\n\nAnd yo can fit the distribution via : \n\nfit(TCopula,data)\n\nExcept that currently it does not work since fit(Distributions.MvTDist,data) does not dispatch. \n\n\n\n\n\n","category":"type"},{"location":"miscellaneous/","page":"Other Copulas","title":"Other Copulas","text":"CurrentModule = Copulas","category":"page"},{"location":"miscellaneous/#Miscellaneous-Copulas","page":"Other Copulas","title":"Miscellaneous Copulas","text":"","category":"section"},{"location":"miscellaneous/","page":"Other Copulas","title":"Other Copulas","text":"A few copulas, while necessary in certain cases and really usefull, are hard to classify. We gether them here for simplicity. ","category":"page"},{"location":"miscellaneous/#Plackett-Copula","page":"Other Copulas","title":"Plackett Copula","text":"","category":"section"},{"location":"miscellaneous/","page":"Other Copulas","title":"Other Copulas","text":"PlackettCopula","category":"page"},{"location":"miscellaneous/#Copulas.PlackettCopula","page":"Other Copulas","title":"Copulas.PlackettCopula","text":"PlackettCopula{P}\n\nFields:     - Œ∏::Real - parameter\n\nConstructor\n\nPlackettCopula(Œ∏)\n\nParameterized by theta  0 The Plackett copula is\n\nC_theta(uv) = fracleft 1+(theta-1)(u+v)right- sqrt1+(theta-1)(u+v)^2-4uvtheta(theta-1)2(theta-1)\n\nand for theta = 1\n\nC_1(uv) = uv \n\nIt has a few special cases: \n\nWhen Œ∏ = 0, is is the MCopula (Upper Frechet-Hoeffding bound)\nWhen Œ∏ = 1, it is the IndependentCopula\nWhen Œ∏ = ‚àû, is is the WCopula (Lower Frechet-Hoeffding bound)\n\nMore details about Plackett Copula are found in:\n\nJoe, H. (2014). Dependence modeling with copulas. CRC press, Page.164\n\nDetails about the algorithm to generate copula samples can be seen in the following references:\n\nJohnson, Mark E. Multivariate statistical simulation:\nA guide to selecting and generating continuous multivariate distributions.\nVol. 192. John Wiley & Sons, 1987. Page 193.\nNelsen, Roger B. An introduction to copulas. Springer, 2006. Exercise 3.38.\n\n\n\n\n\n","category":"type"},{"location":"miscellaneous/#Farlie-Gumbel-Morgenstern-(FGM)-copula","page":"Other Copulas","title":"Farlie-Gumbel-Morgenstern (FGM) copula","text":"","category":"section"},{"location":"miscellaneous/","page":"Other Copulas","title":"Other Copulas","text":"FGMCopula","category":"page"},{"location":"miscellaneous/#Copulas.FGMCopula","page":"Other Copulas","title":"Copulas.FGMCopula","text":"FGMCopula{d,T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nFGMCopula(d, Œ∏)\n\nThe Multivariate Farlie-Gumbel-Morgenstern (FGM) copula of dimension d has 2^d-d-1 parameters theta and function\n\nC(boldsymbolu)=prod_i=1^du_i left1+ sum_k=2^dsum_1 leq j_1  cdots  j_k leq d theta_j_1 cdots j_k baru_j_1cdots baru_j_k right\n\nwhere baru=1-u.\n\nMore details about Farlie-Gumbel-Morgenstern (FGM) copula are found in :\n\nNelsen, Roger B. An introduction to copulas. Springer, 2006. Exercise 3.38.\n\nWe use the stochastic representation of the copula to obtain random samples.\n\nBlier-Wong, C., Cossette, H., & Marceau, E. (2022). Stochastic representation of FGM copulas using multivariate Bernoulli random variables. Computational Statistics & Data Analysis, 173, 107506.\n\nIt has a few special cases:\n\nWhen d=2 and Œ∏ = 0, it is the IndependentCopula.\n\n\n\n\n\n","category":"type"},{"location":"miscellaneous/#Survival-Copula","page":"Other Copulas","title":"Survival Copula","text":"","category":"section"},{"location":"miscellaneous/","page":"Other Copulas","title":"Other Copulas","text":"SurvivalCopula","category":"page"},{"location":"miscellaneous/#Copulas.SurvivalCopula","page":"Other Copulas","title":"Copulas.SurvivalCopula","text":"SurvivalCopula{d,CT,VI}\n\nConstructor\n\nSurvivalCopula(C,indices)\n\nComputes the survival version of any copula on given indices. From a copula C in dimension d, and some indices i_1i_k in 1d, the survival copula associated simply reverses its arguments on chosen indices. For exemple, for d=4 and indices (23), we have: \n\nS(u_1u_4) = C(u_11-u_21-u3u_4)\n\nThis constructor allows to derive new \"survival\" families. For exemple, in bivariate cases, this allows to do \"rotations\". The obtained models can be treated as the starting one, i.e. as a random vector in [0,1]^d with uniforms marginals. \n\n\n\n\n\n","category":"type"},{"location":"miscellaneous/#Empirical-Copulas","page":"Other Copulas","title":"Empirical Copulas","text":"","category":"section"},{"location":"miscellaneous/","page":"Other Copulas","title":"Other Copulas","text":"EmpiricalCopula","category":"page"},{"location":"miscellaneous/#Copulas.EmpiricalCopula","page":"Other Copulas","title":"Copulas.EmpiricalCopula","text":"EmpiricalCopula{d,MT}\n\nFields:\n\nu::MT - the matrix of observations. \n\nConstructor\n\nEmpiricalCopula(u;pseudos=true)\n\nThe EmpiricalCopula in dimension d is parameterized by a pseudo-data matrix wich should have shape (d,N). Its expression is given as :  \n\nC(mathbf x) = frac1Nsum_i=1^n mathbf 1_mathbf u_i le mathbf x\n\nThis function is very practical, be be aware that this is not a true copula (since mathbf u are only pseudo-observations). The constructor allows you to pass dirctly pseudo-observations (the default) or will compute them for you. You can then compute the cdf of the copula, and sample it through the standard interface.\n\n\n\n\n\n","category":"type"},{"location":"archimedean/available_models/","page":"Available Archimedean models","title":"Available Archimedean models","text":"CurrentModule = Copulas","category":"page"},{"location":"archimedean/available_models/#Available-Archimedean-models","page":"Available Archimedean models","title":"Available Archimedean models","text":"","category":"section"},{"location":"archimedean/available_models/#Independence-Copula","page":"Available Archimedean models","title":"Independence Copula","text":"","category":"section"},{"location":"archimedean/available_models/","page":"Available Archimedean models","title":"Available Archimedean models","text":"IndependentGenerator","category":"page"},{"location":"archimedean/available_models/#Copulas.IndependentGenerator","page":"Available Archimedean models","title":"Copulas.IndependentGenerator","text":"IndependentGenerator\n\nConstructor\n\nIndependentGenerator()\nIndependentCopula(d)\n\nThe Independent Copula in dimension d is the simplest copula, that has the form : \n\nC(mathbfx) = prod_i=1^d x_i\n\nIt happends to be an Archimedean Copula, with generator : \n\nphi(t) = exp-t\n\n\n\n\n\n","category":"type"},{"location":"archimedean/available_models/#Frechet-Hoeffding-bounds","page":"Available Archimedean models","title":"Frechet-Hoeffding bounds","text":"","category":"section"},{"location":"archimedean/available_models/","page":"Available Archimedean models","title":"Available Archimedean models","text":"The Frechet-Hoeffding bounds are availiable through the following functions: ","category":"page"},{"location":"archimedean/available_models/","page":"Available Archimedean models","title":"Available Archimedean models","text":"MGenerator","category":"page"},{"location":"archimedean/available_models/#Copulas.MGenerator","page":"Available Archimedean models","title":"Copulas.MGenerator","text":"MGenerator\n\nConstructor\n\nMGenerator()\nMCopula(d)\n\nThe Upper Frechet-Hoeffding bound is the copula with the greatest value among all copulas. It correspond to comonotone random vectors. \n\nFor any copula C, if W and M are (respectively) the lower and uppder Frechet-Hoeffding bounds, we have that for all mathbfu in 01^d,\n\nW(mathbfu) le C(mathbfu) le M(mathbfu)\n\nThe two Frechet-Hoeffding bounds are also Archimedean copulas.\n\n\n\n\n\n","category":"type"},{"location":"archimedean/available_models/","page":"Available Archimedean models","title":"Available Archimedean models","text":"WGenerator","category":"page"},{"location":"archimedean/available_models/#Copulas.WGenerator","page":"Available Archimedean models","title":"Copulas.WGenerator","text":"WGenerator\n\nConstructor\n\nWGenerator()\nWCopula(d)\n\nThe Lower Frechet-Hoeffding bound is the copula with the lowest value among all copulas. Note that W is only a proper copula when d=2, in greater dimensions it is still the (pointwise) lower bound, but not a copula anymore. For any copula C, if W and M are (respectively) the lower and uppder Frechet-Hoeffding bounds, we have that for all mathbfu in 01^d,\n\nW(mathbfu) le C(mathbfu) le M(mathbfu)\n\nThe two Frechet-Hoeffding bounds are also Archimedean copulas.\n\n\n\n\n\n","category":"type"},{"location":"archimedean/available_models/#Clayton-Copula","page":"Available Archimedean models","title":"Clayton Copula","text":"","category":"section"},{"location":"archimedean/available_models/","page":"Available Archimedean models","title":"Available Archimedean models","text":"ClaytonGenerator","category":"page"},{"location":"archimedean/available_models/#Copulas.ClaytonGenerator","page":"Available Archimedean models","title":"Copulas.ClaytonGenerator","text":"ClaytonGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nClaytonGenerator(Œ∏)\nClaytonCopula(d,Œ∏)\n\nThe Clayton copula in dimension d is parameterized by theta in -1(d-1)infty). It is an Archimedean copula with generator : \n\nphi(t) = left(1+mathrmsign(theta)*tright)^-1frac1theta\n\nIt has a few special cases: \n\nWhen Œ∏ = -1/(d-1), it is the WCopula (Lower Frechet-Hoeffding bound)\nWhen Œ∏ = 0, it is the IndependentCopula\nWhen Œ∏ = ‚àû, is is the MCopula (Upper Frechet-Hoeffding bound)\n\n\n\n\n\n","category":"type"},{"location":"archimedean/available_models/#Frank-Copula","page":"Available Archimedean models","title":"Frank Copula","text":"","category":"section"},{"location":"archimedean/available_models/","page":"Available Archimedean models","title":"Available Archimedean models","text":"FrankGenerator","category":"page"},{"location":"archimedean/available_models/#Copulas.FrankGenerator","page":"Available Archimedean models","title":"Copulas.FrankGenerator","text":"FrankGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nFrankGenerator(Œ∏)\nFrankCopula(d,Œ∏)\n\nThe Frank copula in dimension d is parameterized by theta in -inftyinfty). It is an Archimedean copula with generator : \n\nphi(t) = -fraclogleft(1+e^-t(e^-theta-1)right)\theta\n\nIt has a few special cases: \n\nWhen Œ∏ = -‚àû, it is the WCopula (Lower Frechet-Hoeffding bound)\nWhen Œ∏ = 1, it is the IndependentCopula\nWhen Œ∏ = ‚àû, is is the MCopula (Upper Frechet-Hoeffding bound)\n\n\n\n\n\n","category":"type"},{"location":"archimedean/available_models/#Gumbel-Copula","page":"Available Archimedean models","title":"Gumbel Copula","text":"","category":"section"},{"location":"archimedean/available_models/","page":"Available Archimedean models","title":"Available Archimedean models","text":"GumbelGenerator","category":"page"},{"location":"archimedean/available_models/#Copulas.GumbelGenerator","page":"Available Archimedean models","title":"Copulas.GumbelGenerator","text":"GumbelGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nGumbelGenerator(Œ∏)\nGumbelCopula(d,Œ∏)\n\nThe Gumbel copula in dimension d is parameterized by theta in 1infty). It is an Archimedean copula with generator : \n\nphi(t) = exp-t^frac1Œ∏\n\nIt has a few special cases: \n\nWhen Œ∏ = 1, it is the IndependentCopula\nWhen Œ∏ = ‚àû, is is the MCopula (Upper Frechet-Hoeffding bound)\n\n\n\n\n\n","category":"type"},{"location":"archimedean/available_models/#Ali-Mikhail-Haq-Copula","page":"Available Archimedean models","title":"Ali-Mikhail-Haq Copula","text":"","category":"section"},{"location":"archimedean/available_models/","page":"Available Archimedean models","title":"Available Archimedean models","text":"AMHGenerator","category":"page"},{"location":"archimedean/available_models/#Copulas.AMHGenerator","page":"Available Archimedean models","title":"Copulas.AMHGenerator","text":"AMHGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nAMHGenerator(Œ∏)\nAMHCopula(d,Œ∏)\n\nThe AMH copula in dimension d is parameterized by theta in -11). It is an Archimedean copula with generator : \n\nphi(t) = 1 - frac1-thetae^-t-theta\n\nIt has a few special cases: \n\nWhen Œ∏ = 0, it is the IndependentCopula\n\n\n\n\n\n","category":"type"},{"location":"archimedean/available_models/#Joe-Copula","page":"Available Archimedean models","title":"Joe Copula","text":"","category":"section"},{"location":"archimedean/available_models/","page":"Available Archimedean models","title":"Available Archimedean models","text":"JoeGenerator","category":"page"},{"location":"archimedean/available_models/#Copulas.JoeGenerator","page":"Available Archimedean models","title":"Copulas.JoeGenerator","text":"JoeGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nJoeGenerator(Œ∏)\nJoeCopula(d,Œ∏)\n\nThe Joe copula in dimension d is parameterized by theta in 1infty). It is an Archimedean copula with generator : \n\nphi(t) = 1 - left(1 - e^-tright)^frac1theta\n\nIt has a few special cases: \n\nWhen Œ∏ = 1, it is the IndependentCopula\nWhen Œ∏ = ‚àû, is is the MCopula (Upper Frechet-Hoeffding bound)\n\n\n\n\n\n","category":"type"},{"location":"archimedean/available_models/#Gumbel-Barnett-Copula","page":"Available Archimedean models","title":"Gumbel-Barnett Copula","text":"","category":"section"},{"location":"archimedean/available_models/","page":"Available Archimedean models","title":"Available Archimedean models","text":"GumbelBarnettGenerator","category":"page"},{"location":"archimedean/available_models/#Copulas.GumbelBarnettGenerator","page":"Available Archimedean models","title":"Copulas.GumbelBarnettGenerator","text":"GumbelBarnettGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nGumbelBarnettGenerator(Œ∏)\nGumbelBarnettCopula(d,Œ∏)\n\nThe Gumbel-Barnett copula is an archimdean copula with generator:\n\nphi(t) = expŒ∏^-1(1-e^t) 0 leq theta leq 1\n\nMore details about Gumbel-Barnett copula are found in:\n\nJoe, H. (2014). Dependence modeling with copulas. CRC press, Page.437\n\nIt has a few special cases: \n\nWhen Œ∏ = 0, it is the IndependentCopula\n\n\n\n\n\n","category":"type"},{"location":"archimedean/available_models/#Inverse-Gaussian-Copula","page":"Available Archimedean models","title":"Inverse-Gaussian Copula","text":"","category":"section"},{"location":"archimedean/available_models/","page":"Available Archimedean models","title":"Available Archimedean models","text":"InvGaussianGenerator","category":"page"},{"location":"archimedean/available_models/#Copulas.InvGaussianGenerator","page":"Available Archimedean models","title":"Copulas.InvGaussianGenerator","text":"InvGaussianGenerator{T}\n\nFields:\n\nŒ∏::Real - parameter\n\nConstructor\n\nInvGaussianGenerator(Œ∏)\nInvGaussianCopula(d,Œ∏)\n\nThe Inverse Gaussian copula in dimension d is parameterized by theta in 0infty). It is an Archimedean copula with generator :\n\nphi(t) = expfrac(1-sqrt1+2Œ∏^2tŒ∏\n\nMore details about Inverse Gaussian Archimedean copula are found in :\n\nMai, Jan-Frederik, and Matthias Scherer. Simulating copulas: stochastic models, sampling algorithms, and applications. Vol. 6. # N/A, 2017. Page 74.\n\nIt has a few special cases:\n\nWhen Œ∏ = 0, it is the IndependentCopula\n\n\n\n\n\n","category":"type"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = Copulas","category":"page"},{"location":"","page":"Home","title":"Home","text":"Copulas.jl brings most standard copula features into native Julia: random number generation, pdf and cdf, fitting, copula-based multivariate distributions through Sklar's theorem, etc. Since copulas are distribution functions, we fully comply with the Distributions.jl API. This complience allows interoperability with other packages based on this API such as, e.g., Turing.jl.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Usually, people that use and work with copulas turn to R, because of the amazing R package copula. While it is still well maintained and regularly updated, the R poackage copula is a mixture of obscure, heavily optimized C code and more standard R cde, which makes it a complicated code base for readability, extensibility, reliability and maintenance.","category":"page"},{"location":"","page":"Home","title":"Home","text":"This is an attempt to provide a very light, fast, reliable and maintainable copula implementation in native Julia. Among others, one of the notable benefits of such a native implementatioon is the floating point type agnosticity, i.e. compatibility with BigFloat, DoubleFloats, MultiFloats and other kind of numbers.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The package revolves around two main types: ","category":"page"},{"location":"","page":"Home","title":"Home","text":"Copula, an abstract mother type for all the copulas in the package\nSklarDist, a distribution type that allows construction of a multivariate distribution by specifying the copula and the marginals through Sklar's theorem. ","category":"page"},{"location":"","page":"Home","title":"Home","text":"Warning: This is fairly untested and experimental work and the API might change without notice.","category":"page"},{"location":"#Instalation","page":"Home","title":"Instalation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"] add Copulas","category":"page"},{"location":"#Usage","page":"Home","title":"Usage","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The API contains random number generation, cdf and pdf evaluation, and the fit function from Distributions.jl. A typical use case might look like this: ","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Copulas, Distributions, Random\nX‚ÇÅ = Gamma(2,3)\nX‚ÇÇ = Pareto()\nX‚ÇÉ = LogNormal(0,1)\nC = ClaytonCopula(3,0.7) # A 3-variate Clayton Copula with Œ∏ = 0.7\nD = SklarDist(C,(X‚ÇÅ,X‚ÇÇ,X‚ÇÉ)) # The final distribution\n\n# This generates a (3,1000)-sized dataset from the multivariate distribution D\nsimu = rand(D,1000)\n\n# While the following estimates the parameters of the model from a dataset: \nDÃÇ = fit(SklarDist{FrankCopula,Tuple{Gamma,Normal,LogNormal}}, simu)\n# Increase the number of observations to get a beter fit (or not?)  ","category":"page"},{"location":"","page":"Home","title":"Home","text":"Available copula families are:","category":"page"},{"location":"","page":"Home","title":"Home","text":"EllipticalCopulas: GaussianCopula and TCopula\nArchimedeanCopula: WilliamsonCopula (for any generator), but also ClaytonCopula,FrankCopula, AMHCopula, JoeCopula, GumbelCopula, supporting the full ranges in every dimensions (e.g. ClaytonCopula can be sampled with negative dependence in any dimension, not just d=2). \nWCopula, IndependentCopula and MCopula, which are Fr√©chet-Hoeffding bounds,\nPlackettCopula, see ref?\nEmpiricalCopula to follow closely a given dataset.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The next ones to be implemented will probably be: ","category":"page"},{"location":"","page":"Home","title":"Home","text":"Extreme values copulas. \nNested archimedeans (for any generators, with automatic nesting conditions checking). \nBernstein copula and more general Beta copula as smoothing of the Empirical copula. \nCheckerboardCopula (and more generally PatchworkCopula)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Adding a new ArchimedeanCopula is very easy. The Clayton implementation is as short as: ","category":"page"},{"location":"","page":"Home","title":"Home","text":"struct ClaytonCopula{d,T} <: Copulas.ArchimedeanCopula{d}\n    Œ∏::T\nend\nClaytonCopula(d,Œ∏)            = ClaytonCopula{d,typeof(Œ∏)}(Œ∏)     # Constructor\nœï(C::ClaytonCopula, t)        = (1+sign(C.Œ∏)*t)^(-1/C.Œ∏)          # Generator\nœï‚Åª¬π(C::ClaytonCopula,t)       = sign(C.Œ∏)*(t^(-C.Œ∏)-1)            # Inverse Generator\nœÑ(C::ClaytonCopula)           = C.Œ∏/(C.Œ∏+2)                       # Œ∏ -> œÑ\nœÑ‚Åª¬π(::Type{ClaytonCopula},œÑ)  = 2œÑ/(1-œÑ)                          # œÑ -> Œ∏\nwilliamson_dist(C::ClaytonCopula{d,T}) where {d,T} = WilliamsonFromFrailty(Distributions.Gamma(1/C.Œ∏,1),d) # Radial distribution","category":"page"},{"location":"","page":"Home","title":"Home","text":"The Archimedean API is modular: ","category":"page"},{"location":"","page":"Home","title":"Home","text":"To sample an archimedean, only œï is required. Indeed, the williamson_dist has a generic fallback that uses WilliamsonTransforms.jl for any generator. Note however that providing the williamson_dist yourself if you know it will allow sampling to be an order of magnitude faster.\nTo evaluate the cdf and (log-)density in any dimension, only œï and œï‚Åª¬π are needed.\nCurrently, to fit the copula œÑ‚Åª¬π is needed as we use the inverse tau moment method. But we plan on also implementing inverse rho and MLE (density needed). \nNote that the generator œï follows the convention œï(0)=1, while others (e.g., https://en.wikipedia.org/wiki/Copula(probabilitytheory)#Archimedean_copulas) use œï‚Åª¬π as the generator.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Please take a look at the documentation for more details. ","category":"page"},{"location":"#Dev-Roadmap","page":"Home","title":"Dev Roadmap","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Next:","category":"page"},{"location":"","page":"Home","title":"Home","text":"[ ] More documentation and tests for the current implementation. \n[ ] Docs: show how to use the WilliamsonCopula to implement generic archimedeans.\n[ ] Give the user the choice of fitting method via fit(dist,data; method=\"MLE\") or fit(dist,data; method=\"itau\") or fit(dist,data; method=\"irho\").\n[ ] Fitting a generic archimedean with an empirically produced generarator\n[ ] Automatic checking of generator d-monotonicity ? Dunno if it is even possible. ","category":"page"},{"location":"","page":"Home","title":"Home","text":"Maybe later:","category":"page"},{"location":"","page":"Home","title":"Home","text":"[ ] NestedArchimedean, with automatic checking of nesting conditions for generators. \n[ ] Vines?\n[ ] Archimax ?\n[ ] BernsteinCopula and BetaCopula could also be implemented. \n[ ] PatchworkCopula and CheckerboardCopula: could be nice things to have :)\n[ ] Goodness of fits tests ?","category":"page"},{"location":"#Contributions-are-welcome","page":"Home","title":"Contributions are welcome","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"If you want to contribute to the package, found a bug in it or simply want to chat, do not hesitate to open an issue on this repo. ","category":"page"},{"location":"#Citation","page":"Home","title":"Citation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"@software{oskar_laverny_2023_10084669,\n  author       = {Oskar Laverny},\n  title        = {Copulas.jl: A fully `Distributions.jl`-compliant copula package},\n  year         = 2022+,\n  doi          = {10.5281/zenodo.6652672},\n  url          = {https://doi.org/10.5281/zenodo.6652672}\n}","category":"page"}]
}
