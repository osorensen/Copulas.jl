<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Fitting compound distributions · Copulas.jl</title><meta name="title" content="Fitting compound distributions · Copulas.jl"/><meta property="og:title" content="Fitting compound distributions · Copulas.jl"/><meta property="twitter:title" content="Fitting compound distributions · Copulas.jl"/><meta name="description" content="Documentation for Copulas.jl."/><meta property="og:description" content="Documentation for Copulas.jl."/><meta property="twitter:description" content="Documentation for Copulas.jl."/><meta property="og:url" content="https://lrnv.github.io/Copulas.jl/examples/fitting_sklar/"/><meta property="twitter:url" content="https://lrnv.github.io/Copulas.jl/examples/fitting_sklar/"/><link rel="canonical" href="https://lrnv.github.io/Copulas.jl/examples/fitting_sklar/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Copulas.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Copulas.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Copulas.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../sklar/">Sklar&#39;s Distributions</a></li><li><a class="tocitem" href="../../elliptical/generalities/">Elliptical Copulas</a></li><li><a class="tocitem" href="../../archimedean/generalities/">Archimedean Copulas</a></li><li><a class="tocitem" href="../../Liouville/">Liouville Copulas</a></li><li><a class="tocitem" href="../../empirical/generalities/">Empirical Copulas</a></li><li><a class="tocitem" href="../../dependence_measures/">Dependence measures</a></li></ul></li><li><span class="tocitem">Bestiary</span><ul><li><a class="tocitem" href="../../elliptical/available_models/">Elliptical Copulas</a></li><li><a class="tocitem" href="../../archimedean/available_models/">Archimedean Generators</a></li><li><a class="tocitem" href="../../empirical/available_models/">Empirical Copulas</a></li><li><a class="tocitem" href="../../miscellaneous/">Other Copulas</a></li><li><a class="tocitem" href="../../transformations/">Transformed Copulas</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../lossalae/">Loss-Alae fitting example.</a></li><li class="is-active"><a class="tocitem" href>Fitting compound distributions</a></li><li><a class="tocitem" href="../turing/">Bayesian inference with <code>Turing.jl</code></a></li><li><a class="tocitem" href="../other_usecases/">Other known use cases.</a></li></ul></li><li><a class="tocitem" href="../../dev_roadmap/">Dev Roadmap</a></li><li><a class="tocitem" href="../../idx/">Package Index</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Fitting compound distributions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Fitting compound distributions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lrnv/Copulas.jl/blob/main/docs/src/examples/fitting_sklar.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Fitting-compound-distributions"><a class="docs-heading-anchor" href="#Fitting-compound-distributions">Fitting compound distributions</a><a id="Fitting-compound-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-compound-distributions" title="Permalink"></a></h1><p>Through the <code>SklarDist</code> interface, there is the possibility to fit directly distributions that are constructed from a copula and some marginals:</p><pre><code class="language-julia hljs">using Copulas
using Distributions

# Let&#39;s sample some datas:
X₁ = LogNormal()
X₂ = Pareto()
X₃ = Gamma()
X₄ = Normal()
C = SurvivalCopula(FrankCopula(4,7),(2,4))
D = SklarDist(C,(X₁,X₂,X₃,X₄))
data = rand(D,1000)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4×1000 Matrix{Float64}:
  1.7793     0.657658   0.117374   …   0.188143   0.242316   2.36973
  1.16419    2.30532    2.60125       40.4798     6.23852    1.37674
  1.50823    2.47797    0.0590837      0.0219568  0.700355   0.838323
 -0.799798  -0.0640706  0.944512       0.81717    1.92146   -0.350304</code></pre><p>The fit function uses a type as its first argument that describes the structure of the model : </p><pre><code class="language-julia hljs">MyCop = SurvivalCopula{4,ClaytonCopula,(2,4)}
MyMargs = Tuple{LogNormal,Pareto,Gamma,Normal}
MyD = SklarDist{MyCop, MyMargs}
fitted_model = fit(MyD,data)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SklarDist{SurvivalCopula{4, ClaytonCopula{4, Float64}, Tuple{Int64, Int64}}, Tuple{Distributions.LogNormal{Float64}, Distributions.Pareto{Float64}, Distributions.Gamma{Float64}, Distributions.Normal{Float64}}}(
C: SurvivalCopula{4, ClaytonCopula{4, Float64}, Tuple{Int64, Int64}}(
C: ClaytonCopula{4, Float64}(
G: Copulas.ClaytonGenerator{Float64}(2.4169012423916407)
)

indices: (2, 4)
)

m: (Distributions.LogNormal{Float64}(μ=0.03021424545127251, σ=0.9573349398353782), Distributions.Pareto{Float64}(α=1.0516399788213582, θ=1.0001701673681718), Distributions.Gamma{Float64}(α=1.0728454404426209, θ=0.9582687295879427), Distributions.Normal{Float64}(μ=-0.02219934084338999, σ=0.9734263549962107))
)
</code></pre><p>Another possibility is to use an empirical copula and only fit the marginals: </p><pre><code class="language-julia hljs">other_fitted_model = fit(SklarDist{EmpiricalCopula,MyMargs},data)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SklarDist{EmpiricalCopula{4, LinearAlgebra.Transpose{Float64, Matrix{Float64}}}, Tuple{Distributions.LogNormal{Float64}, Distributions.Pareto{Float64}, Distributions.Gamma{Float64}, Distributions.Normal{Float64}}}(
C: EmpiricalCopula{4, LinearAlgebra.Transpose{Float64, Matrix{Float64}}}(
u: [0.7202797202797203 0.3226773226773227 … 0.060939060939060936 0.8041958041958042; 0.13686313686313686 0.5754245754245755 … 0.8481518481518482 0.2757242757242757; 0.7862137862137862 0.9140859140859141 … 0.47652347652347654 0.5474525474525475; 0.1918081918081918 0.5044955044955045 … 0.975024975024975 0.37962037962037964]
)

m: (Distributions.LogNormal{Float64}(μ=0.03021424545127251, σ=0.9573349398353782), Distributions.Pareto{Float64}(α=1.0516399788213582, θ=1.0001701673681718), Distributions.Gamma{Float64}(α=1.0728454404426209, θ=0.9582687295879427), Distributions.Normal{Float64}(μ=-0.02219934084338999, σ=0.9734263549962107))
)
</code></pre><p>This simple interface leverages indeed the <code>fit</code> function from <code>Distributions.jl</code>. From their documentation, this function is not supposed to use a particular method but to fit &quot;dirt and quick&quot; some distributions. </p><p>So you have to be careful: the fit method might not be the same for different copulas or different marginals. For example, the Archimedean copulas are fitted through an inversion of the Kendall tau function, while the Gaussian copula is fitted by maximum likelihood. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lossalae/">« Loss-Alae fitting example.</a><a class="docs-footer-nextpage" href="../turing/">Bayesian inference with <code>Turing.jl</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Tuesday 20 February 2024 15:36">Tuesday 20 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
